# 相机组件

```{note}
This document describes a new experimental API. The more traditional approach
for handling a camera is described in [](camera_and_viewport.md).
```

相机作为组件是构建游戏的另一种方法，这种方法可以更灵活地放置相机，甚至可以同时拥有多个相机。

为了理解这种方法是如何工作的，假设你的游戏世界是一个存在的实体 _某处_ 独立于你的应用程序。想象一下，你的游戏只是一个窗口，你可以通过它观察那个世界。你可以随时关闭那个窗口，游戏世界仍然存在。或者，相反，你可以打开多个同时查看同一个世界（或不同世界）的窗口。

有了这种心态，我们现在可以理解相机作为组件的工作原理。

首先，有 [](#world) 类，其中包含游戏世界中的所有组件。这 `世界` 组件可以安装在任何地方，例如游戏类的根目录。

然后，一个 [](#cameracomponent)“查看”的类 `World`.这 `相机组件` 有个 `视口` 和一个 `取景器` 在内部，既可以灵活地在屏幕上的任何位置渲染世界，也可以控制观看位置和角度。


## World

该组件应用于托管构成你的游戏世界的所有其他组件。的主要属性 `World` 类是它不通过传统方式呈现——而是创建一个或多个 [](#cameracomponent)s 去“看”这个世界。

一个游戏可以有多个 `World` 可以在同一时间或不同时间呈现的实例。例如，如果你有两个世界 A 和 B 以及一个摄像机，那么将该摄像机的目标从 A 切换到 B 将立即将视图切换到世界 B，而无需卸载 A 再安装 B。


## CameraComponent

这是一个组件，通过它 `World` 被渲染。它需要引用一个 `World` 施工期间的实例；但是稍后可以用另一个目标世界替换目标世界。多台摄像机可以同时观察同一个世界。

一种 `CameraComponent` 里面还有另外两个组件：a[](#viewport) 和一个 [](#viewfinder).不像 `World` 对象，相机拥有视口和取景器，这意味着这些组件是相机的孩子。

还有一个静态属性 `CameraComponent.currentCamera` 仅在渲染阶段不为空，它返回当前执行渲染的相机对象。这仅适用于组件渲染取决于相机设置的某些高级用例。例如，如果某些组件在相机的视口之外，它们可能会决定跳过渲染它们自己和它们的子级。


## Viewport

这 `Viewport` 是一个窗口，通过它 `World` 可见。该窗口在屏幕上具有一定的大小、形状和位置。有多种视口可用，你始终可以实现自己的视口。

这 `Viewport` 是一个组件，这意味着你可以向其中添加其他组件。这些子组件将受视口位置的影响，但不受其剪辑蒙版的影响。因此，如果视口是进入游戏世界的“窗口”，那么它的子项就是你可以放在窗口顶部的东西。

将元素添加到视口是实现“HUD”组件的便捷方式。

可以使用以下视口：
  - `MaxViewport`（默认）——这个视口扩展到游戏允许的最大尺寸，即它将等于游戏画布的尺寸。
  - `FixedSizeViewport`-- 一个具有预定义大小的简单矩形视口。
  - `FixedAspectRatioViewport`-- 一个矩形视口，可扩展以适应游戏画布，但保留其纵横比。
  - `CircularViewport`-- 一个圆形的视口，固定大小。


## Viewfinder

相机的这一部分负责了解我们当前正在查看的底层游戏世界中的哪个位置。这 `Viewfinder` 还控制缩放级别和视图的旋转角度。

这 `anchor` 取景器的属性允许你指定视口内的哪个点用作相机的“逻辑中心”。例如，在横向卷轴动作游戏中，通常将镜头对准不在屏幕中央而是靠近左下角显示的主角。这个偏离中心的位置将是相机的“逻辑中心”，由取景器的 `anchor`.

添加到的组件 `Viewfinder` 因为孩子将被渲染为好像他们是世界的一部分（但在顶部）。将行为组件添加到取景器中会更有用，例如 [](effects.md) 或其他控制器。


## 与传统相机的比较

与普通人相比 [Camera](camera_and_viewport.md)， 这 `CameraComponent` 有几个优点和缺点。

优点：
  - 游戏中可以同时添加多个摄像头；
  - 更灵活地选择视口的位置和大小；
  - 将相机从一个世界切换到另一个世界可以瞬间发生，无需卸载一个世界然后安装另一个世界；
  - 支持世界观的旋转；
  - (NYI) 效果可以应用于视口或取景器；
  - (NYI) 更灵活的相机控制器。

缺点（我们计划在不久的将来消除这些）：
  - 相机控制尚未实现；
  - 事件传播可能并不总是正常工作。
